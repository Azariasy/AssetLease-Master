
# Finance Master - 集团财务数据中心 (v3.1)

**Finance Master** 是一个专为集团型企业设计的轻量级财务数据分析与对账工具。它基于现代 Web 技术构建，完全运行在浏览器端，通过 IndexedDB 实现数据本地持久化，确保财务数据绝不离开用户电脑，安全且高效。

当前版本专门针对 **中移（成都）信息通信科技有限公司（成研院）** 与 **中国移动通信集团有限公司成都产业研究院分公司（成研分公司）** 的双主体架构进行了深度定制，核心解决跨主体关联交易对账难、ERP 报表查询慢、数据无法长期留存的痛点。

---

## 📅 项目进度与版本历史

### v3.1 (当前版本) - 深度对账与月度穿透
- [x] **月度对账明细**：在关联交易雷达图中，支持点击查看具体的月度差异表，快速定位是哪个月份不平。
- [x] **处置建议**：针对未匹配的对账记录，提供基于财务逻辑的处置建议（如跨期检查、科目误用检查）。
- [x] **UI/UX 优化**：重新设计仪表盘，强化关联交易状态的视觉反馈。

### v3.0 - 架构重构与数据持久化
- [x] **多主体架构**：引入 `Entity ID` 概念，支持“上市”与“非上市”多套账套并行管理。
- [x] **本地数据库 (IndexedDB)**：引入 `Dexie.js`，实现百万级凭证数据的本地存储，刷新页面不丢失，支持历史数据回溯。
- [x] **关联交易雷达**：首创“我方收入 vs 对方成本”自动比对算法，实时监控关联交易合规性。
- [x] **智能解析**：优化 Excel/CSV 解析引擎，兼容 SAP/Oracle 等主流 ERP 导出的复杂表头结构。

### v2.0 & v1.0 - 基础功能
- [x] **科目余额表查询**：支持按部门、往来段的多维透视。
- [x] **明细账查询**：支持摘要、金额的模糊搜索。

---

## 核心功能亮点

### 1. 双主体自动对账
系统内置了 **成研院** 与 **成研分公司** 的互认逻辑。
- 当您在“成研院”账套导入数据时，系统自动识别往来单位为“成研分公司”的收入。
- 同时在数据库中检索“成研分公司”账套中，往来单位为“成研院”的成本/费用。
- **自动计算差额**：无需人工 VLOOKUP，系统实时给出差额，并精确到月份。

### 2. 沉浸式财务分析
- **趋势分析**：自动提取 6001 (收入) 和 6401/6602 (成本费用) 科目，生成经营利润趋势图。
- **多维透视**：在余额表中，可以一键切换“按部门聚合”或“按客商聚合”，轻松回答“哪个部门花钱最多”或“哪个客户欠款最多”。

### 3. 数据安全与隐私
- **零上传**：所有 Excel/CSV 文件解析均在浏览器内存中完成。
- **本地存储**：解析后的数据存储于浏览器内置的 IndexedDB 中，物理上位于您的硬盘里，不经过任何云端服务器。

---

## 🛠 技术栈
- **核心框架**: React 19, TypeScript
- **UI 组件**: Tailwind CSS, Lucide React
- **图表引擎**: Recharts
- **数据存储**: Dexie.js (IndexedDB wrapper)
- **文件处理**: SheetJS (XLSX)

---

## 🚀 快速开始

1. **环境准备**：
   - 推荐使用 Chrome 或 Edge 浏览器以获得最佳性能。
   - 不需要安装任何后端服务，直接打开 `index.html` 即可运行（开发模式下）。

2. **数据导入流程**：
   - 步骤一：在左侧菜单切换到 **“上市主体 (成研院)”**。
   - 步骤二：进入“数据导入”，上传该主体的《科目余额表》和《账户明细表》。
   - 步骤三：在左侧菜单切换到 **“非上市主体 (成研分公司)”**。
   - 步骤四：同样上传该主体的报表。

3. **查看对账结果**：
   - 回到 **“看板与对账”** 首页。
   - 右侧的“关联交易对账雷达”将自动显示两家公司的对账结果。
   - 点击存在差额的项目，查看具体差异月份。

---

## ⚠️ 注意事项
- **科目配置**：默认预置了移动体系常用的科目代码（如 6001 收入，6602 管理费用）。如您的 ERP 科目代码不同，请在“系统配置”页进行修改。
- **浏览器缓存**：清除浏览器缓存会清空 IndexedDB 中的财务数据，请谨慎操作或定期保留原始 Excel 文件备份。
